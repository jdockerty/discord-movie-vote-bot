image: python:3.8

stages:
  - test
  # - deploy

test:
  stage: test
  script:
    - apt-get update -qy
    - pip install awscli
    - aws s3 cp s3://movie-vote-bot-bucket/config.yaml .
    - pip install -r requirements.txt
    - export bot_environment=testing
    - python bot.py &
    - python bot_test.py --channel 720200786167988297 --run all $TARGET_BOT_ID $TESTER_BOT_TOKEN
    - kill $!

# production:
#   stage: deploy
#   script:
#     - apt-get update -qy
#   only:
#     - master